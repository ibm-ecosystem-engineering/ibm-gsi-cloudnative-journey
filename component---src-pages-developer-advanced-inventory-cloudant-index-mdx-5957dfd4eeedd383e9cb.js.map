{"version":3,"sources":["webpack:///./src/pages/developer-advanced/inventory-cloudant/index.mdx"],"names":["name","_frontmatter","PageDescription","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-developer-advanced-inventory-cloudant-index-mdx-5957dfd4eeedd383e9cb.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/ibm-gsi-cloudnative-journey/ibm-gsi-cloudnative-journey/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nimport Globals from 'gatsby-theme-carbon/src/templates/Globals';\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst PageDescription = makeShortcode(\"PageDescription\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n\n    <PageDescription mdxType=\"PageDescription\">\n      <p>{`Add a Cloudant integration to your backend service`}</p>\n    </PageDescription>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`While logged into the IBM Cloud account use the resource list to find your pre installed Cloudant database instance name after your development cluster.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Open the database instance dashboard.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Click on the Service Credentials on the left-hand menu.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`You will see the credentials for the database.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Open a terminal window folder/directory called `}<inlineCode parentName=\"p\">{`data`}</inlineCode></p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`mkdir data\n`}</code></pre>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`To help create test JSON data we are going to supply a template to the JSON Generator tool, this helps when creating dummy data for testing. Navigate to the following link `}<a parentName=\"p\" {...{\n            \"href\": \"https://www.json-generator.com/\"\n          }}>{`https://www.json-generator.com/`}</a></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Replace the default template with the following template (using cut and paste). This will enable a 100 records of test data to be created to represent a products database. Click on the `}<em parentName=\"p\">{`Generate`}</em>{` button.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`[\n  '{{repeat(1, 50)}}',\n  {\n    id: '{{objectId()}}',\n    manufacturer: '{{company().toUpperCase()}}',\n    name:  '{{lorem(3, \"words\")}}',\n    price: '{{floating(10, 1000, 2, \"0.00\")}}',\n    stock: '{{integer(1, 100)}}'\n  }\n]\n`}</code></pre>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Copy the generated contents on the right hand side into a file called `}<inlineCode parentName=\"p\">{`inventory.json`}</inlineCode>{` and save it into the same folder. Wrap the array with a docs statement.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-json\"\n          }}>{`{\n  \"docs\": <Add Generated array here>\n}\n`}</code></pre>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Save the documents that will be loaded into Cloudant`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Download the `}<inlineCode parentName=\"p\">{`dataload.sh`}</inlineCode>{` script from the Iteration Zero repository - `}<a parentName=\"p\" {...{\n            \"href\": \"https://raw.githubusercontent.com/ibm-garage-cloud/ibm-garage-iteration-zero/master/terraform/scripts/dataload.sh\"\n          }}>{`https://raw.githubusercontent.com/ibm-garage-cloud/ibm-garage-iteration-zero/master/terraform/scripts/dataload.sh`}</a></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Add the `}<inlineCode parentName=\"p\">{`username`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`apikey`}</inlineCode>{` to `}<inlineCode parentName=\"p\">{`CLOUDANT_USERNAME`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`CLOUDANT_API_KEY`}</inlineCode>{` variables in the `}<inlineCode parentName=\"p\">{`dataload.sh`}</inlineCode>{` script.\nYou can get the credentials from the Cloudant credentials view in the IBM Cloud console.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Add `}<inlineCode parentName=\"p\">{`DATABASE`}</inlineCode>{` value to be `}<inlineCode parentName=\"p\">{`inventory-<replace with namespace>`}</inlineCode>{` using the dev namespace/project name you have been using.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Save the script, make it executable, and then run it by passing in the filename`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-bash\"\n          }}>{`chmod +x ./dataload.sh\n./dataload.sh inventory.json\n`}</code></pre>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`The data from the `}<inlineCode parentName=\"p\">{`inventory.json`}</inlineCode>{` file will then be used to populate the database, to confirm this on the Dashboard click on Manage menu on the left and then Launch button to see the Cloudant dashboard.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Click on the Left icon that looks like a Database and you will see the `}<inlineCode parentName=\"p\">{`inventory-<namespace>`}</inlineCode>{` database created.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Click on the `}<inlineCode parentName=\"p\">{`inventory`}</inlineCode>{` database, then click `}<strong parentName=\"p\">{`Table`}</strong>{` view.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`You can see the rows of data\n`}<span parentName=\"p\" {...{\n            \"className\": \"gatsby-resp-image-wrapper\",\n            \"style\": {\n              \"position\": \"relative\",\n              \"display\": \"block\",\n              \"marginLeft\": \"auto\",\n              \"marginRight\": \"auto\",\n              \"maxWidth\": \"1152px\"\n            }\n          }}>{`\n      `}<span parentName=\"span\" {...{\n              \"className\": \"gatsby-resp-image-background-image\",\n              \"style\": {\n                \"paddingBottom\": \"47.91666666666667%\",\n                \"position\": \"relative\",\n                \"bottom\": \"0\",\n                \"left\": \"0\",\n                \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABk0lEQVQoz4WSu27cQAxF9f+/4yp1ihTu0hkB4rWTlbQrjTTvh2Z2b0jKsgOnyADEEITm8PKK3aItllXDWoeUMspWcZ49bMjIpSJvDbVStD1auyHlDasJcKEgxoRA8fQy4fms0BkXsdWbPEqpYLURXx5fcRoM5QnnydLDLA20y/CxwPosETin+qwjHr6d8PV7j04bQ10b7vc7gStWUqzUIqpnpTFOi6hctKN8RUwb1GoJnkhplbojsBxidCkXGYWBPOLroPD084wfpx7Pv6+4Lh4mVPSTwa9RQZmMgXJlMxZXRN3qN8xU51oHHPA72u0GtWj0w4hhJNikYJwXS7Rx0ORzIWuM9eIjCwhx9333u+5AhgmwvQF7Bl4wzQQkSG0MtLhcJ3q4SY0nY1BM+33EP0D2jtXx45m8dD4I0JLSZTWi5FC4A/P/gePlA8igAzirVRRyE77/HvkTEJ8UXgQ6zzuQPWRV3IQBO7C+K9zI17K1D+Bx+G/zgpu38IF2lD7iRoUUpZToLrJekXJear6DLPeu9A+TjQRNk4tVqgAAAABJRU5ErkJggg==')\",\n                \"backgroundSize\": \"cover\",\n                \"display\": \"block\"\n              }\n            }}></span>{`\n  `}<img parentName=\"span\" {...{\n              \"className\": \"gatsby-resp-image-image\",\n              \"alt\": \"Database\",\n              \"title\": \"Database\",\n              \"src\": \"/ibm-gsi-cloudnative-journey/static/9b560c3709cfb5556d183c9af0c51c44/3cbba/database.png\",\n              \"srcSet\": [\"/ibm-gsi-cloudnative-journey/static/9b560c3709cfb5556d183c9af0c51c44/7fc1e/database.png 288w\", \"/ibm-gsi-cloudnative-journey/static/9b560c3709cfb5556d183c9af0c51c44/a5df1/database.png 576w\", \"/ibm-gsi-cloudnative-journey/static/9b560c3709cfb5556d183c9af0c51c44/3cbba/database.png 1152w\", \"/ibm-gsi-cloudnative-journey/static/9b560c3709cfb5556d183c9af0c51c44/0b124/database.png 1728w\", \"/ibm-gsi-cloudnative-journey/static/9b560c3709cfb5556d183c9af0c51c44/fac46/database.png 1746w\"],\n              \"sizes\": \"(max-width: 1152px) 100vw, 1152px\",\n              \"style\": {\n                \"width\": \"100%\",\n                \"height\": \"100%\",\n                \"margin\": \"0\",\n                \"verticalAlign\": \"middle\",\n                \"position\": \"absolute\",\n                \"top\": \"0\",\n                \"left\": \"0\"\n              },\n              \"loading\": \"lazy\"\n            }}></img>{`\n    `}</span></p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`If you click on a row of data, you will see the raw NoSQL form of the data record.`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`This completes the setup of the database and populating it with data.`}</p>\n      </li>\n    </ul>\n    <h3>{`Enable database in the solution`}</h3>\n    <p>{`If you are starting from the solution, use the following steps to enable the Cloudant database`}</p>\n    <h4>{`Set up local development`}</h4>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Open the mappings.json file under src/main/resources and add a `}<inlineCode parentName=\"p\">{`DATABASE_NAME`}</inlineCode>{` value with the value `}<inlineCode parentName=\"p\">{`inventory-{namespace}`}</inlineCode>{` where `}<inlineCode parentName=\"p\">{`namespace`}</inlineCode>{` is the namespace where the pipeline is running (e.g. dev-{initials})`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-json\",\n            \"metastring\": \"path=src/main/resources/mappings.json\",\n            \"path\": \"src/main/resources/mappings.json\"\n          }}>{`{\n  \"DATABASE_NAME\": \"inventory-{namespace}\"\n}\n`}</code></pre>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Log into cloud.ibm.com and open the Cloudant service from the resource list`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Click on service credentials and expand the listed credentials`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Copy the json contents from the credentials into `}<inlineCode parentName=\"p\">{`mappings.json`}</inlineCode>{` under the `}<inlineCode parentName=\"p\">{`CLOUDANT_CONFIG`}</inlineCode>{` object (note that CLOUDANT_CONFIG value must be a string type not a json type, so you must use escaping characters for this value)`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-json\",\n            \"metastring\": \"path=src/main/resources/mappings.json\",\n            \"path\": \"src/main/resources/mappings.json\"\n          }}>{`{\n  \"DATABASE_NAME\": \"inventory-{namespace}\",\n  \"CLOUDANT_CONFIG\": \"{paste json here}\"\n}\n`}</code></pre>\n      </li>\n    </ul>\n    <h4>{`Activate the Clouant service implementation`}</h4>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Open `}<inlineCode parentName=\"p\">{`src/main/java/com/ibm/inventory_management/services/StockItemMockService.java`}</inlineCode>{` and remove the `}<inlineCode parentName=\"p\">{`@Profile(\"mock\")`}</inlineCode>{` annotation`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Open `}<inlineCode parentName=\"p\">{`src/main/java/com/ibm/inventory_management/services/StockItemService.java`}</inlineCode>{` and add the `}<inlineCode parentName=\"p\">{`@Primary`}</inlineCode>{` annotation. The file should look like the following`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-java\",\n            \"metastring\": \"path=src/main/java/com/ibm/inventory_management/services/StockItemService.java\",\n            \"path\": \"src/main/java/com/ibm/inventory_management/services/StockItemService.java\"\n          }}>{`package com.ibm.inventory_management.services;\nimport org.springframework.context.annotation.Primary;\nimport org.springframework.context.annotation.Profile;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Lazy;\n...\n@Service\n@Primary\npublic class StockItemService implements StockItemApi {\n@Bean\npublic static CloudantClient buildCloudant(CloudantConfig config) throws CloudServicesException { \n    System.out.println(\"Config: \" + config);\n    URL url = null;\n    try {\n        url = new URL(config.getUrl());\n    } catch (MalformedURLException e) {\n        throw new CloudServicesException(\"Invalid service URL specified\", e);\n    }\n   return ClientBuilder\n            .url(url)\n            .iamApiKey(config.getApikey())\n            //.username(config.getUsername())\n            //.password(config.getPassword())\n            .build();\n}\nprivate CloudantConfig config;\nprivate CloudantClient client;\nprivate Database db = null;\npublic StockItemService(CloudantConfig config, @Lazy CloudantClient client) {\n    this.config = config;\n    this.client = client;\n}\n@PostConstruct\npublic void init() {\n    db = client.database(config.getDatabaseName(), true);\n}\n@Override\n...\n}\n`}</code></pre>\n      </li>\n    </ul>\n    <h4>{`Update the configuration values in the `}<inlineCode parentName=\"h4\">{`values.yaml`}</inlineCode>{` helm chart`}</h4>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Open the `}<inlineCode parentName=\"p\">{`values.yaml`}</inlineCode>{` file and update the values for `}<inlineCode parentName=\"p\">{`cloudantBinding`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`databaseName`}</inlineCode></p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\",\n            \"metastring\": \"path=chart/template-java-spring/values.yaml\",\n            \"path\": \"chart/template-java-spring/values.yaml\"\n          }}>{`cloudantBinding=\"{binding name}\"\ndatabaseName=\"inventory-{namespace}\"\n`}</code></pre>\n        <p parentName=\"li\">{`  `}<strong parentName=\"p\">{`Note:`}</strong>{` The cloudantBinding value should match the name of the cloudant binding secret`}</p>\n      </li>\n    </ul>\n    <h3>{`Add a Cloudant integration to your backend service`}</h3>\n    <p>{`If you are following the instructions from MicroApp part 1 and want to enable the Cloudant database\nyourself, use the following directions.`}</p>\n    <h4>{`Update the gradle config to include cloudant dependencies`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`Enable the cloudant libraries by applying the `}<inlineCode parentName=\"li\">{`build-cloudant.gradle`}</inlineCode>{` to the end of the\nbuild.gradle file`}</li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-groovy\",\n        \"metastring\": \"path=build.gradle\",\n        \"path\": \"build.gradle\"\n      }}>{`apply from:   'gradle/build-cloudant.gradle'\n`}</code></pre>\n    <ul>\n      <li parentName=\"ul\">{`Run `}<inlineCode parentName=\"li\">{`./gradlew init`}</inlineCode>{` to validate the changes and load the libraries `}</li>\n    </ul>\n    <h4>{`Configuration values`}</h4>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`CloudantConfig is added to hold the url, username, password, and databaseName values`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`In CloudantMapping,logic is implemented to load the configuration from the secret binding or local file .`}</p>\n      </li>\n    </ul>\n    <h4>{`Set up local development`}</h4>\n    <ul>\n      <li parentName=\"ul\">{`Open the mappings.json file under src/main/resources and add a `}<inlineCode parentName=\"li\">{`DATABASE_NAME`}</inlineCode>{` value with the value\n`}<inlineCode parentName=\"li\">{`inventory-{namespace}`}</inlineCode>{` where `}<inlineCode parentName=\"li\">{`namespace`}</inlineCode>{` is the namespace where the pipeline is running (e.g. dev-{initials})`}</li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\",\n        \"metastring\": \"path=src/main/resources/mappings.json\",\n        \"path\": \"src/main/resources/mappings.json\"\n      }}>{`{\n  \"DATABASE_NAME\": \"inventory-{namespace}\"\n}\n`}</code></pre>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Log into cloud.ibm.com and open the Cloudant service from the resource list`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Click on service credentials and expand the listed credentials`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Copy the json contents from the credentials into `}<inlineCode parentName=\"p\">{`mappings.json`}</inlineCode>{` under the `}<inlineCode parentName=\"p\">{`CLOUDANT_CONFIG`}</inlineCode>{` object`}</p>\n      </li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\",\n        \"metastring\": \"path=src/main/resources/mappings.json\",\n        \"path\": \"src/main/resources/mappings.json\"\n      }}>{`{\n  \"DATABASE_NAME\": \"inventory-{namespace}\",\n  \"CLOUDANT_CONFIG\": \"{paste json here}\"\n}\n`}</code></pre>\n    <h4>{`Service Implementation`}</h4>\n    <ul>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`CloudantApi component is added to create the CloudantClient instance from the configuration`}</p>\n      </li>\n      <li parentName=\"ul\">\n        <p parentName=\"li\">{`Open the `}<inlineCode parentName=\"p\">{`deployment.yaml`}</inlineCode>{` file and add environment variables that use those values to the top of the\nexisting `}<inlineCode parentName=\"p\">{`env`}</inlineCode>{` block`}</p>\n      </li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\",\n        \"metastring\": \"path=chart/template-java-spring/templates/deployment.yaml\",\n        \"path\": \"chart/template-java-spring/templates/deployment.yaml\"\n      }}>{`          env:\n            - name: CLOUDANT_CONFIG\n              valueFrom:\n                secretKeyRef:\n                  name: {{ .Values.cloudantBinding | quote }}\n                  key: binding\n            - name: DATABASE_NAME\n              value: {{ .Values.databaseName | quote }}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}