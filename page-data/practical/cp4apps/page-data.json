{"componentChunkName":"component---src-pages-practical-cp-4-apps-index-mdx","path":"/practical/cp4apps/","result":{"pageContext":{"frontmatter":{"title":"Explore CP4APP"},"relativePagePath":"/practical/cp4apps/index.mdx","titleType":"page","MdxNode":{"id":"1747ba85-510f-5b96-a3e4-ab05868a7f70","children":[],"parent":"fa34aba2-43a7-527a-bcfb-c7b39e980de4","internal":{"content":"---\ntitle: Explore CP4APP\n---\n\nimport Globals from 'gatsby-theme-carbon/src/templates/Globals';\n\n<PageDescription>\n\nUse IBM Cloud Pak for Applications to build new cloud-native applications\n\n</PageDescription>\n\nThis guide assumes the following:\n\n1. You are using a <Globals name=\"env\" /> that has already been installed.\n1. Cloud Pak for Applications has already been installed in the environment.\n1. Ensure the  Secret for IBM Cloud Registry is configured for the Tekton Pipeline\n1. Docker is installed and running \n\nThis guide consists of the following sections:\n\n<AnchorLinks>\n  <AnchorLink to=\"#cp4apps-dashboard\">CP4Apps Dashboard</AnchorLink>\n  <AnchorLink to=\"#cp4apps-dev-tools\">CP4Apps Dev Tools</AnchorLink>\n  <AnchorLink to=\"#create-a-new-app-using-the-appsody-cli\">Create a new app using the Appsody CLI</AnchorLink>\n  <AnchorLink to=\"#create-a-new-app-using-codewind\">Create a new app using Codewind</AnchorLink>\n  <AnchorLink to=\"#build-an-app-with-a-tekton-pipeline\">Build an app with a Tekton pipeline</AnchorLink>\n  <AnchorLink to=\"#scale-to-zero-with-serverless\">Scale to zero with Serverless</AnchorLink>\n</AnchorLinks>\n\n\n## CP4Apps dashboard\n\nOpen the Cloud Pak for Applications dashboard.\n\n- Open the OpenShift web console\n\n- Click on the App Launcher and select \"Cloud Pak for Applications\"\n\n    ![CP4Apps Launcher](images/icp4apps-launcher-v4.png)\n\nIn the CP4Apps dashboard, familiarize yourself with the console pages.\n\n- Explore the Instance, Docs, and Guides pages\n\n    ![CP4Apps Landing](images/icp4apps-landing-v4.png)\n\n\n## CP4Apps Dev Tools\n\nSet up the dev tools.\n\n- In the CP4Apps dashboard, on the Home page, go to the Develop new cloud-native apps\n\n- Press Setup Dev Tools to see the instructions we'll follow below\n\n    ![Setup CP4Apps Dev Tools](images/icp4apps-devtools-v4.png)\n\nInstall Codewind and Appsody.\n\n- [Install Codewind for VS Code IDE](https://www.eclipse.org/codewind/vsc-getting-started.html)\n\n- [Install Codewind for Eclipse IDE](https://www.eclipse.org/codewind/eclipse-getting-started.html)\n\n- [Install the Appsody CLI](https://appsody.dev/docs/getting-started/installation)\n\n    ![Setup CP4Apps Dev Tools](images/icp4apps-devtools-1-v4.png)\n\nWe've installed both Codewind and Appsody to show you how to use both. As you'll see, they have many features in common.\n\n\n## Create a new app using the Appsody CLI\n\nNow that we've installed the Appsody CLI, we'll configure it and use it to implement an app.\n\n### Configure the Appsody CLI\n\nThe CP4Apps installation in your OpenShift cluster includes an instance of Kabanero. In the CP4Apps dashboard, the Instance page shows details about this Kabanero instance. Configure your Appsody CLI to access this instance.\n\n- In the CP4Apps dashboard, go to the Instance page\n\n- In the Instance section of the Instances tab, copy the Appsody URL (i.e. {Appsody-URL})\n\n- Add the repository in Kabanero to your local Appsody CLI's configuration\n\n    ```bash\n    appsody repo add kabanero-0.6.3 {Appsody-URL}\n    ```\n\n    For example:\n\n    ```bash\n    appsody repo add kabanero-0.6.3 https://github.com/kabanero-io/kabanero-stack-hub/releases/download/0.6.3/kabanero-stack-hub-index.yaml  \n    ```\n\nMake the repo in Kabanero the default, as shown by the astrix (`*`) in the list of repos.\n\n- Set the default repo and list them\n\n    ```bash\n    $ appsody repo set-default kabanero-0.6.3\n    $ appsody repo list\n\n    NAME                    URL\n    *kabanero-0.6.3         https://github.com/kabanero-io/kabanero-stack-hub/releases/download/0.6.3/kabanero-stack-hub-index.yaml\n    incubator               https://github.com/appsody/stacks/releases/latest/download/incubator-index.yaml\n    ```\n\n- List the technology stacks included in the repo\n\n    ```bash\n    $ appsody list kabanero-0.6.3\n\n    REPO            ID                      VERSION         TEMPLATES               DESCRIPTION\n    kabanero-0.6.3\tjava-microprofile\t    0.2.26   \t    *default         \t    Eclipse MicroProfile on Open Liberty & OpenJ9 using Maven\n    kabanero-0.6.3\tjava-openliberty \t    0.2.3    \t    *default         \t    Open Liberty & OpenJ9 using Maven\n    kabanero-0.6.3  java-spring-boot2       0.3.24          *default, kotlin        Spring Boot using OpenJ9 and Maven\n    kabanero-0.6.3  nodejs                  0.3.3           *simple                 Runtime for Node.js applications\n    kabanero-0.6.3  nodejs-express          0.2.10          scaffold, *simple       Express web framework for Node.js\n    ```\n\n    Notice that the stacks listed are the same as the list of Stacks back on the Instance page.\n\n\n### Create an application\n\nNow that we've configured our Appsody CLI, let's use it to create an application.\n\nCreate an application named `nodejs-express-{initials}` using Appsody and the Kabanero application stack in our cluster.\n\n- Create an empty project directory named `nodejs-express-{initials}`\n\n    ```bash\n    mkdir -p ~/projects/nodejs-express-{initials}\n    cd ~/projects/nodejs-express-{initials}\n    ```\n\n- Initialize the project\n    ```bash\n    appsody init kabanero-0.6.3/nodejs-express\n    ```\n\nTo run the application, you don't need to have node.js or the Java SDK installed on your workstation. The application will run in a container that includes all of the tools.\n\n- Start the application\n    ```bash\n    appsody run\n    ```\n\nWhenever any of the application files are edited, Kabanero detects the change and automatically restarts the application.\n\n- Using your favorite editor, edit `app.js`\n\n- Change the response to `Hello Garage`.\n\nNotice that the change is detected and the application automatically restarted.\n\n<InlineNotification>\n\nEach Appsody stack comes with instrumentation that you can access with the following endpoints:\n- Application endpoint: http://localhost:3000/\n- Health endpoint: http://localhost:3000/health\n- Liveness endpoint: http://localhost:3000/live\n- Readiness endpoint: http://localhost:3000/ready\n- Metrics endpoint: http://localhost:3000/metrics\n- Dashboard endpoint: http://localhost:3000/appmetrics-dash (development only)\n\n</InlineNotification>\n\nWhile the application is running, experiment with using its instrumentation endpoints.\n\nWhen you're through with the application, stop it.\n\n- Open another shell and switch to the same application directory (e.g. ``~/projects/nodejs-express-{initials}`)`\n\n- Stop the application\n    ```bash\n    appsody stop\n    ```\n\n## Create a new app using Codewind\n\nNow that we've installed the Codewind plugin, we'll configure it and use it to implement an app.\n\n### Configure the Codewind plugin\n\nThe CP4Apps installation in your OpenShift cluster includes an instance of Kabanero. In the CP4Apps dashboard, the Instance page shows details about this Kabanero instance. Configure your Codewind plugin to access this instance.\n\nSet the Collection Hub URL as a Template Source in Codewind:\n\n- Both for VS Code IDE and Eclpise IDC, see [Configuring template sources for VS Code](https://www.eclipse.org/codewind/workingwithtemplates.html)\n\n\n### Create an application\n\nNow that we've configured our Codewind plugin, let's use it to create an application.\n\nCreate an application named `nodejs-express-{initials}` using Codewind and the Kabanero application stack in our cluster.\n\n- Select Projects (Local), then select New Project\n\n- Select the \"Kabanero Node.js Express simple template (Appsody Stacks - kabanero-0.6.3)\" template from the list\n\n- Specify a name, such as `nodejs-express-{initials}`\n\nThe application will start.\n\nTo work with the source code, right click on Projects and select Open CodeWind Workspace.\n\nExperiment with using Codewind to perform actions on your running application.\n\n- In the CodeWind view, right click on your application to see the actions the plugin can perform. \n\n\n- Perform each of the actions on your application:\n    - Open Application\n    - Open Project Overview, verify the ports and status\n    - Open Container Shell, explore the filesystem\n    - Open Application Monitor/ Metrics Dashboard, use the application and see the traffic metrics\n    - Open Performance Dashboard and run a load test, see the traffic metrics\n    - Restart in Debug mode, insert a break point in `app.js` and run the app to stop the application in debug view\n\n\n## Build an app with a Tekton pipeline\n\nTo deploy an app using Tekton, we'll need:\n- a project in OpenShift to deploy the app to\n- a Git repo for the app's code with a webhook that triggers the Tekton pipeline\n- the code for the app that goes in the Git repo\n\nWhen the code is pushed to the git repo, the pipeline will get triggered.\n\n\n### Create OpenShift project\n\nCreate a project or use an existing one. Set the OpenShift Container Platform CLI to use the project.\n\n- Find your project in OpenShift named `dev-{initials}`\n\n    - If it doesn't already exist, create it\n        ```bash\n        oc new-project dev-{initials}\n        ```\n\n- Change context to your project\n    ```bash\n    oc project dev-{initials}\n    ```\n\n- Verify project context\n    ```bash\n    oc project -q\n    ```\n\n\n### Create the Git Repo and add the base code to the repository\n\nCreate a Git repository for your app and connect it to the Tekton pipeline.\n\nFirst, create the Git repo.\n\n- In your github repository, create a Git repo named `nodejs-express-{initials}`\n\n- For example, `https://github.com/{your-git-repo}/nodejs-express-cs.git`\n\n<Tabs>\n<Tab label=\"Desktop/Laptop\" open=\"true\">  \n\n\n-  Generate the Appsody manifest\n   ```bash\n    appsody deploy --generate-only\n    ```\n    \n- Check the files into Git\n    ```bash\n    git init\n    git add .\n    git commit -m \"first commit\"\n    ```\n\n- Configure the local repo to map to the git remote repo you created and sync them.\n\n- Add the remote repo URL and push\n    ```bash\n    git remote add origin 'https://github.com/{repo-name}/nodejs-express-{initials}.git'\n    git push -u origin master\n    ```\n\n</Tab>\n<Tab label=\"Cloud Shell\" open=\"true\">\n\n- Clone the appsody based node-js template project from the git for deployment \n\n    ```bash\n    git clone https://github.com/ibm-gsi-ecosystem/appsody-template-node-js.git\n    cd appsody-template-node-js/\n    ```\n    \n- List your existing remotes in order to get the name of the remote you want to change.\n    ```bash\n    git remote -v\n    > origin  https://github.com/ibm-gsi-ecosystem/appsody-template-node-js.git (fetch)\n    > origin  https://github.com/ibm-gsi-ecosystem/appsody-template-node-js.git (push)\n    ```\n\n- Change the remote's URL from the clone repo to your git repo.\n    ```bash\n    git remote set-url origin 'https://github.com/{repo-name}/nodejs-express-{initials}.git'\n    ```\n\n- Now list your existing remotes and you will see that it points to your repo\n    ```bash\n    git remote -v\n    > origin  'https://github.com/{repo-name}/nodejs-express-{initials}.git' (fetch)\n    > origin  'https://github.com/{repo-name}/nodejs-express-{initials}.git' (push)\n    ```\n\n- Configure the credentials for your git hub\n    ```\n    git config --global user.email \"you@example.com\"\n    git config --global user.name \"Your Name\"\n    ```\n- Change the name of the name of the project to 'nodejs-express-{initial} from 'appsody-template-node-js'\n\n   <InlineNotification kind=\"edityaml\"> \n\n    From\n    ```\n    name: appsody-template-node-js\n    ```\n\n    To\n    ```\n    name: nodejs-express-{initials}\n    ```\n    </InlineNotification>\n\n- Check the files into Git\n    ```bash\n    git init\n    git add .\n    git commit -m \"first commit\"\n    git push\n    ```\n\n</Tab>\n</Tabs>\n\n\n\n### Connect the pipeline to Git\n\n\n\nOpen the Tekton dashboard.\n\n- In the CP4Apps dashboard, go to the Instance page\n\n- In the Piplines section, click on the Manage pipelines to open the Tekton dashboard\n\n    - If prompted, log in using OpenShift\n\n    - If prompted, allow access\n\n<InlineNotification>\n\n- In the Tekton dashboard, select the Pipelines page\n\nNotice that Kabanero includes pipelines for building apps based on different technologies: MicroProfile, Open Liberty, Spring Boot, Node.js, and Express.js. When a pipeline runs, it'll run in a certain Kubernetes namespace (a.k.a. OpenShift project). Each of the pipeline's tasks will run in a new container and pod. A task's steps all run in the same container.\n\n</InlineNotification>\n\nThird, create the webhook. The Kabanero instance already includes several pipelines. Create a webhook in the Git repo that triggers the proper pipeline.\n\n- In the Tekton dashboard, select the Webhooks page\n\n- Press Add Webhook\n\n- In the Create Webhook form, enter the following values:\n\n    ![Create Webhook](images/create-webhook4.png)\n\n    - **Name**: `nodejs-express-{initials}`, such as `nodejs-express-cs`\n    - **Repository URL**: `https://github.com/{repo-name}/nodejs-express-{initials}.git`, such as `https://github.com/{ibmworkshop}/nodejs-express-{cs}.git`\n    - **Access Token**: Select your `github.access-token` (no need to create a new access token)\n    - **Namespace**: Select `kabanero` (not your own namespace)\n    - **Pipeline**: Select `nodejs-express-build-deploy-pipeline`\n    - **Service Account**: Select `kabanero-operator`\n    - **Docker Registry**: `{ibm region registry location}}/{ibmcloud-namespace}`, such as `uk.icr.io/sandbox-team-one`\n\n<InlineNotification>\n\nThe webhook doesn't just notify Tekton when the Git repo's contents have changed. The webhook also specifies what pipeline to run, what namespace to run it in, the [Kubernetes service account](https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/) to use to run it, and the registry for the tasks' container images.\n\n</InlineNotification>\n\n- Press Create to close the form and create the webhook\n\n### Configure the application deployment\n  \n  \n- Edit the generated file, `app-deploy.yaml`\n\n    - Specify the namespace to deploy the application into\n    ```yaml\n    metadata:\n      namespace: dev-{initials}\n    ```\n    \n    - Add the service account name as 'default'. You need to make this entry under section 'spec':\n    ```yaml\n    spec:\n      serviceAccountName: default\n        \n\n- Check the files into Git\n    ```bash\n    git status\n    git add .\n    git commit -m \"added namespace and serviceAccountName\"\n    ```\n\n\n### Push the app and trigger the pipeline\n\nConfigure the local repo to map to the git renote repo you created earlier and sync them.\n\n- Add the remote repo URL and push\n    ```bash\n    git push\n    ```\n\nWhen you push the changes to the server, that triggers the Tekton pipeline.\n\n- In the Tekton dashboard, select the PipelineRuns page. The page shows the list of pipelines.\n\n    ![PipelineRuns](images/icp4apps-pipelinerun-2.png)\n\n    \n\n- When you access one of the pipelines, the details of the pipeline tasks are displayed\n\n    ![PipelineRuns](images/icp4apps-pipelinerun-1.png)\n\n\n<InlineNotification>\n\nClick on a PipelineRun to see its details. In its list of Tasks, expand one to see its steps. Select a step to see its details: logs, status, and details.\n\n</InlineNotification>\n\n## Scale to zero with Serverless\n\nUse the Git repo created for Tekton to deploy the app using Knative.\n\n- Edit the generated file, `app-deploy.yaml`\n\n    - Set the variable `createKnativeService` to `true`\n    ```yaml\n    spec:\n      createKnativeService: true\n    ```\n\n- Push the change to Git\n    ```bash\n    git add app-deploy.yaml\n    git commit -m \"make it serverless\"\n    git push origin\n    ```\n\nWatch the pipeline run in the Tekton dashboard.\n\n- When the Tekton pipeline is finished, get the URL of the Knative service\n    ```bash\n    $ oc get ksvc\n\n    NAME                URL                                                                                                                               LATESTCREATED             LATESTREADY               READY   REASON\n    nodejs-express-cs   http://nodejs-express-cs.dev-cs.mooc-surge-ocp-cluster-0143c5dd31acd8e030a1d6e0ab1380e3-0001.us-east.containers.appdomain.cloud   nodejs-express-cs-gfvfz   nodejs-express-cs-gfvfz   True\n    ```\n","type":"Mdx","contentDigest":"04941b1287b9ceb7f6e26d25d9c2eef1","counter":1010,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Explore CP4APP"},"exports":{},"rawBody":"---\ntitle: Explore CP4APP\n---\n\nimport Globals from 'gatsby-theme-carbon/src/templates/Globals';\n\n<PageDescription>\n\nUse IBM Cloud Pak for Applications to build new cloud-native applications\n\n</PageDescription>\n\nThis guide assumes the following:\n\n1. You are using a <Globals name=\"env\" /> that has already been installed.\n1. Cloud Pak for Applications has already been installed in the environment.\n1. Ensure the  Secret for IBM Cloud Registry is configured for the Tekton Pipeline\n1. Docker is installed and running \n\nThis guide consists of the following sections:\n\n<AnchorLinks>\n  <AnchorLink to=\"#cp4apps-dashboard\">CP4Apps Dashboard</AnchorLink>\n  <AnchorLink to=\"#cp4apps-dev-tools\">CP4Apps Dev Tools</AnchorLink>\n  <AnchorLink to=\"#create-a-new-app-using-the-appsody-cli\">Create a new app using the Appsody CLI</AnchorLink>\n  <AnchorLink to=\"#create-a-new-app-using-codewind\">Create a new app using Codewind</AnchorLink>\n  <AnchorLink to=\"#build-an-app-with-a-tekton-pipeline\">Build an app with a Tekton pipeline</AnchorLink>\n  <AnchorLink to=\"#scale-to-zero-with-serverless\">Scale to zero with Serverless</AnchorLink>\n</AnchorLinks>\n\n\n## CP4Apps dashboard\n\nOpen the Cloud Pak for Applications dashboard.\n\n- Open the OpenShift web console\n\n- Click on the App Launcher and select \"Cloud Pak for Applications\"\n\n    ![CP4Apps Launcher](images/icp4apps-launcher-v4.png)\n\nIn the CP4Apps dashboard, familiarize yourself with the console pages.\n\n- Explore the Instance, Docs, and Guides pages\n\n    ![CP4Apps Landing](images/icp4apps-landing-v4.png)\n\n\n## CP4Apps Dev Tools\n\nSet up the dev tools.\n\n- In the CP4Apps dashboard, on the Home page, go to the Develop new cloud-native apps\n\n- Press Setup Dev Tools to see the instructions we'll follow below\n\n    ![Setup CP4Apps Dev Tools](images/icp4apps-devtools-v4.png)\n\nInstall Codewind and Appsody.\n\n- [Install Codewind for VS Code IDE](https://www.eclipse.org/codewind/vsc-getting-started.html)\n\n- [Install Codewind for Eclipse IDE](https://www.eclipse.org/codewind/eclipse-getting-started.html)\n\n- [Install the Appsody CLI](https://appsody.dev/docs/getting-started/installation)\n\n    ![Setup CP4Apps Dev Tools](images/icp4apps-devtools-1-v4.png)\n\nWe've installed both Codewind and Appsody to show you how to use both. As you'll see, they have many features in common.\n\n\n## Create a new app using the Appsody CLI\n\nNow that we've installed the Appsody CLI, we'll configure it and use it to implement an app.\n\n### Configure the Appsody CLI\n\nThe CP4Apps installation in your OpenShift cluster includes an instance of Kabanero. In the CP4Apps dashboard, the Instance page shows details about this Kabanero instance. Configure your Appsody CLI to access this instance.\n\n- In the CP4Apps dashboard, go to the Instance page\n\n- In the Instance section of the Instances tab, copy the Appsody URL (i.e. {Appsody-URL})\n\n- Add the repository in Kabanero to your local Appsody CLI's configuration\n\n    ```bash\n    appsody repo add kabanero-0.6.3 {Appsody-URL}\n    ```\n\n    For example:\n\n    ```bash\n    appsody repo add kabanero-0.6.3 https://github.com/kabanero-io/kabanero-stack-hub/releases/download/0.6.3/kabanero-stack-hub-index.yaml  \n    ```\n\nMake the repo in Kabanero the default, as shown by the astrix (`*`) in the list of repos.\n\n- Set the default repo and list them\n\n    ```bash\n    $ appsody repo set-default kabanero-0.6.3\n    $ appsody repo list\n\n    NAME                    URL\n    *kabanero-0.6.3         https://github.com/kabanero-io/kabanero-stack-hub/releases/download/0.6.3/kabanero-stack-hub-index.yaml\n    incubator               https://github.com/appsody/stacks/releases/latest/download/incubator-index.yaml\n    ```\n\n- List the technology stacks included in the repo\n\n    ```bash\n    $ appsody list kabanero-0.6.3\n\n    REPO            ID                      VERSION         TEMPLATES               DESCRIPTION\n    kabanero-0.6.3\tjava-microprofile\t    0.2.26   \t    *default         \t    Eclipse MicroProfile on Open Liberty & OpenJ9 using Maven\n    kabanero-0.6.3\tjava-openliberty \t    0.2.3    \t    *default         \t    Open Liberty & OpenJ9 using Maven\n    kabanero-0.6.3  java-spring-boot2       0.3.24          *default, kotlin        Spring Boot using OpenJ9 and Maven\n    kabanero-0.6.3  nodejs                  0.3.3           *simple                 Runtime for Node.js applications\n    kabanero-0.6.3  nodejs-express          0.2.10          scaffold, *simple       Express web framework for Node.js\n    ```\n\n    Notice that the stacks listed are the same as the list of Stacks back on the Instance page.\n\n\n### Create an application\n\nNow that we've configured our Appsody CLI, let's use it to create an application.\n\nCreate an application named `nodejs-express-{initials}` using Appsody and the Kabanero application stack in our cluster.\n\n- Create an empty project directory named `nodejs-express-{initials}`\n\n    ```bash\n    mkdir -p ~/projects/nodejs-express-{initials}\n    cd ~/projects/nodejs-express-{initials}\n    ```\n\n- Initialize the project\n    ```bash\n    appsody init kabanero-0.6.3/nodejs-express\n    ```\n\nTo run the application, you don't need to have node.js or the Java SDK installed on your workstation. The application will run in a container that includes all of the tools.\n\n- Start the application\n    ```bash\n    appsody run\n    ```\n\nWhenever any of the application files are edited, Kabanero detects the change and automatically restarts the application.\n\n- Using your favorite editor, edit `app.js`\n\n- Change the response to `Hello Garage`.\n\nNotice that the change is detected and the application automatically restarted.\n\n<InlineNotification>\n\nEach Appsody stack comes with instrumentation that you can access with the following endpoints:\n- Application endpoint: http://localhost:3000/\n- Health endpoint: http://localhost:3000/health\n- Liveness endpoint: http://localhost:3000/live\n- Readiness endpoint: http://localhost:3000/ready\n- Metrics endpoint: http://localhost:3000/metrics\n- Dashboard endpoint: http://localhost:3000/appmetrics-dash (development only)\n\n</InlineNotification>\n\nWhile the application is running, experiment with using its instrumentation endpoints.\n\nWhen you're through with the application, stop it.\n\n- Open another shell and switch to the same application directory (e.g. ``~/projects/nodejs-express-{initials}`)`\n\n- Stop the application\n    ```bash\n    appsody stop\n    ```\n\n## Create a new app using Codewind\n\nNow that we've installed the Codewind plugin, we'll configure it and use it to implement an app.\n\n### Configure the Codewind plugin\n\nThe CP4Apps installation in your OpenShift cluster includes an instance of Kabanero. In the CP4Apps dashboard, the Instance page shows details about this Kabanero instance. Configure your Codewind plugin to access this instance.\n\nSet the Collection Hub URL as a Template Source in Codewind:\n\n- Both for VS Code IDE and Eclpise IDC, see [Configuring template sources for VS Code](https://www.eclipse.org/codewind/workingwithtemplates.html)\n\n\n### Create an application\n\nNow that we've configured our Codewind plugin, let's use it to create an application.\n\nCreate an application named `nodejs-express-{initials}` using Codewind and the Kabanero application stack in our cluster.\n\n- Select Projects (Local), then select New Project\n\n- Select the \"Kabanero Node.js Express simple template (Appsody Stacks - kabanero-0.6.3)\" template from the list\n\n- Specify a name, such as `nodejs-express-{initials}`\n\nThe application will start.\n\nTo work with the source code, right click on Projects and select Open CodeWind Workspace.\n\nExperiment with using Codewind to perform actions on your running application.\n\n- In the CodeWind view, right click on your application to see the actions the plugin can perform. \n\n\n- Perform each of the actions on your application:\n    - Open Application\n    - Open Project Overview, verify the ports and status\n    - Open Container Shell, explore the filesystem\n    - Open Application Monitor/ Metrics Dashboard, use the application and see the traffic metrics\n    - Open Performance Dashboard and run a load test, see the traffic metrics\n    - Restart in Debug mode, insert a break point in `app.js` and run the app to stop the application in debug view\n\n\n## Build an app with a Tekton pipeline\n\nTo deploy an app using Tekton, we'll need:\n- a project in OpenShift to deploy the app to\n- a Git repo for the app's code with a webhook that triggers the Tekton pipeline\n- the code for the app that goes in the Git repo\n\nWhen the code is pushed to the git repo, the pipeline will get triggered.\n\n\n### Create OpenShift project\n\nCreate a project or use an existing one. Set the OpenShift Container Platform CLI to use the project.\n\n- Find your project in OpenShift named `dev-{initials}`\n\n    - If it doesn't already exist, create it\n        ```bash\n        oc new-project dev-{initials}\n        ```\n\n- Change context to your project\n    ```bash\n    oc project dev-{initials}\n    ```\n\n- Verify project context\n    ```bash\n    oc project -q\n    ```\n\n\n### Create the Git Repo and add the base code to the repository\n\nCreate a Git repository for your app and connect it to the Tekton pipeline.\n\nFirst, create the Git repo.\n\n- In your github repository, create a Git repo named `nodejs-express-{initials}`\n\n- For example, `https://github.com/{your-git-repo}/nodejs-express-cs.git`\n\n<Tabs>\n<Tab label=\"Desktop/Laptop\" open=\"true\">  \n\n\n-  Generate the Appsody manifest\n   ```bash\n    appsody deploy --generate-only\n    ```\n    \n- Check the files into Git\n    ```bash\n    git init\n    git add .\n    git commit -m \"first commit\"\n    ```\n\n- Configure the local repo to map to the git remote repo you created and sync them.\n\n- Add the remote repo URL and push\n    ```bash\n    git remote add origin 'https://github.com/{repo-name}/nodejs-express-{initials}.git'\n    git push -u origin master\n    ```\n\n</Tab>\n<Tab label=\"Cloud Shell\" open=\"true\">\n\n- Clone the appsody based node-js template project from the git for deployment \n\n    ```bash\n    git clone https://github.com/ibm-gsi-ecosystem/appsody-template-node-js.git\n    cd appsody-template-node-js/\n    ```\n    \n- List your existing remotes in order to get the name of the remote you want to change.\n    ```bash\n    git remote -v\n    > origin  https://github.com/ibm-gsi-ecosystem/appsody-template-node-js.git (fetch)\n    > origin  https://github.com/ibm-gsi-ecosystem/appsody-template-node-js.git (push)\n    ```\n\n- Change the remote's URL from the clone repo to your git repo.\n    ```bash\n    git remote set-url origin 'https://github.com/{repo-name}/nodejs-express-{initials}.git'\n    ```\n\n- Now list your existing remotes and you will see that it points to your repo\n    ```bash\n    git remote -v\n    > origin  'https://github.com/{repo-name}/nodejs-express-{initials}.git' (fetch)\n    > origin  'https://github.com/{repo-name}/nodejs-express-{initials}.git' (push)\n    ```\n\n- Configure the credentials for your git hub\n    ```\n    git config --global user.email \"you@example.com\"\n    git config --global user.name \"Your Name\"\n    ```\n- Change the name of the name of the project to 'nodejs-express-{initial} from 'appsody-template-node-js'\n\n   <InlineNotification kind=\"edityaml\"> \n\n    From\n    ```\n    name: appsody-template-node-js\n    ```\n\n    To\n    ```\n    name: nodejs-express-{initials}\n    ```\n    </InlineNotification>\n\n- Check the files into Git\n    ```bash\n    git init\n    git add .\n    git commit -m \"first commit\"\n    git push\n    ```\n\n</Tab>\n</Tabs>\n\n\n\n### Connect the pipeline to Git\n\n\n\nOpen the Tekton dashboard.\n\n- In the CP4Apps dashboard, go to the Instance page\n\n- In the Piplines section, click on the Manage pipelines to open the Tekton dashboard\n\n    - If prompted, log in using OpenShift\n\n    - If prompted, allow access\n\n<InlineNotification>\n\n- In the Tekton dashboard, select the Pipelines page\n\nNotice that Kabanero includes pipelines for building apps based on different technologies: MicroProfile, Open Liberty, Spring Boot, Node.js, and Express.js. When a pipeline runs, it'll run in a certain Kubernetes namespace (a.k.a. OpenShift project). Each of the pipeline's tasks will run in a new container and pod. A task's steps all run in the same container.\n\n</InlineNotification>\n\nThird, create the webhook. The Kabanero instance already includes several pipelines. Create a webhook in the Git repo that triggers the proper pipeline.\n\n- In the Tekton dashboard, select the Webhooks page\n\n- Press Add Webhook\n\n- In the Create Webhook form, enter the following values:\n\n    ![Create Webhook](images/create-webhook4.png)\n\n    - **Name**: `nodejs-express-{initials}`, such as `nodejs-express-cs`\n    - **Repository URL**: `https://github.com/{repo-name}/nodejs-express-{initials}.git`, such as `https://github.com/{ibmworkshop}/nodejs-express-{cs}.git`\n    - **Access Token**: Select your `github.access-token` (no need to create a new access token)\n    - **Namespace**: Select `kabanero` (not your own namespace)\n    - **Pipeline**: Select `nodejs-express-build-deploy-pipeline`\n    - **Service Account**: Select `kabanero-operator`\n    - **Docker Registry**: `{ibm region registry location}}/{ibmcloud-namespace}`, such as `uk.icr.io/sandbox-team-one`\n\n<InlineNotification>\n\nThe webhook doesn't just notify Tekton when the Git repo's contents have changed. The webhook also specifies what pipeline to run, what namespace to run it in, the [Kubernetes service account](https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/) to use to run it, and the registry for the tasks' container images.\n\n</InlineNotification>\n\n- Press Create to close the form and create the webhook\n\n### Configure the application deployment\n  \n  \n- Edit the generated file, `app-deploy.yaml`\n\n    - Specify the namespace to deploy the application into\n    ```yaml\n    metadata:\n      namespace: dev-{initials}\n    ```\n    \n    - Add the service account name as 'default'. You need to make this entry under section 'spec':\n    ```yaml\n    spec:\n      serviceAccountName: default\n        \n\n- Check the files into Git\n    ```bash\n    git status\n    git add .\n    git commit -m \"added namespace and serviceAccountName\"\n    ```\n\n\n### Push the app and trigger the pipeline\n\nConfigure the local repo to map to the git renote repo you created earlier and sync them.\n\n- Add the remote repo URL and push\n    ```bash\n    git push\n    ```\n\nWhen you push the changes to the server, that triggers the Tekton pipeline.\n\n- In the Tekton dashboard, select the PipelineRuns page. The page shows the list of pipelines.\n\n    ![PipelineRuns](images/icp4apps-pipelinerun-2.png)\n\n    \n\n- When you access one of the pipelines, the details of the pipeline tasks are displayed\n\n    ![PipelineRuns](images/icp4apps-pipelinerun-1.png)\n\n\n<InlineNotification>\n\nClick on a PipelineRun to see its details. In its list of Tasks, expand one to see its steps. Select a step to see its details: logs, status, and details.\n\n</InlineNotification>\n\n## Scale to zero with Serverless\n\nUse the Git repo created for Tekton to deploy the app using Knative.\n\n- Edit the generated file, `app-deploy.yaml`\n\n    - Set the variable `createKnativeService` to `true`\n    ```yaml\n    spec:\n      createKnativeService: true\n    ```\n\n- Push the change to Git\n    ```bash\n    git add app-deploy.yaml\n    git commit -m \"make it serverless\"\n    git push origin\n    ```\n\nWatch the pipeline run in the Tekton dashboard.\n\n- When the Tekton pipeline is finished, get the URL of the Knative service\n    ```bash\n    $ oc get ksvc\n\n    NAME                URL                                                                                                                               LATESTCREATED             LATESTREADY               READY   REASON\n    nodejs-express-cs   http://nodejs-express-cs.dev-cs.mooc-surge-ocp-cluster-0143c5dd31acd8e030a1d6e0ab1380e3-0001.us-east.containers.appdomain.cloud   nodejs-express-cs-gfvfz   nodejs-express-cs-gfvfz   True\n    ```\n","fileAbsolutePath":"/home/runner/work/ibm-gsi-cloudnative-journey/ibm-gsi-cloudnative-journey/src/pages/practical/cp4apps/index.mdx"}}}}